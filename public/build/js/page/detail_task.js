$(function(){var a=+taskData.power,e=new Box({title:"任务改量",html:'<form class="change_num_form"><input type="hidden" name="task_id" value="'+taskData.id+'"><div class="grid_nowrap"><div class="ct_4"><label class="whether"><input type="checkbox" checked class="isPos"><span class="opt_imitate">加</span><span class="opt_imitate">减</span></label></div><div class="ct_4-3"><label class="suffix"><input type="text" name="task_cg_num" data-validate="require,+"><span class="opt_imitate">个</span></label></div></div></form>',css:{width:"300px"},fnSure:function(a,e){var t=$(".change_num_form");if(!base.formValidate(t))return!1;var n=+$('[name="task_cg_num"]',t).val(),s={id:$('[name="task_id"]',t).val(),num:$(".isPos").prop("checked")?n:-n};$.ajax({url:"http://es2.laizhuan.com/back/task/change_num",type:"POST",dataType:"json",data:s}).done(function(a){1==a.status?$(".btn_modify_num").parent().operTip(a.msg||"操作成功！",{theme:"success",css:{"white-space":"nowrap",left:"auto",right:"-2em"}}):$(".btn_modify_num").parent().operTip(a.msg||"操作失败！",{theme:"danger",css:{"white-space":"nowrap",left:"auto",right:"-2em"}})}).fail(function(a){console.dir(a)})},fnCancel:function(a){}});-1===a&&$(".btn_modify").removeClass("hidden"),1===a&&$(".btn_modify_num").removeClass("hidden"),$("body").on("click",".btn_modify_num",function(){e.show()}),$("body").on("click",".btn_modify",function(){oper_task.box.initHeader("修改任务"),oper_task.box.operType="modify",oper_task.box.initContent("http://es2.laizhuan.com/back/page/task_add .add_task_form",function(){oper_task.box.show(),oper_task.initWidget(),$("form.add_task .show_by_edit").removeClass("hidden").find("input").prop("disabled",!1),window.oper_task.renderTaskForm(taskData)});var a=$(this).parent();oper_task.box.afterfnSure=function(e,t){e?a.operTip(t||"操作成功！",{theme:"warning",css:{"white-space":"nowrap"}}):a.operTip(t||"操作失败！",{theme:"danger",css:{"white-space":"nowrap"}})}}).on("click",".btn_copy",function(){oper_task.box.initHeader("任务续单"),oper_task.box.operType="insert",oper_task.box.initContent("http://es2.laizhuan.com/back/page/task_add .add_task_form",function(){oper_task.box.show(),oper_task.initWidget(),window.oper_task.renderTaskForm(taskData)});var a=$(this).parent();oper_task.box.afterfnSure=function(e,t){e?(a.operTip(t||"操作成功！",{theme:"warning",css:{"white-space":"nowrap"}}),window.close()):a.operTip(t||"操作失败！",{theme:"danger",css:{"white-space":"nowrap"}})}})});